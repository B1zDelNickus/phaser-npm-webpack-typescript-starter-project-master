var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),PhaserAds;!function(e){!function(e){e[e.start=0]="start",e[e.firstQuartile=1]="firstQuartile",e[e.midPoint=2]="midPoint",e[e.thirdQuartile=3]="thirdQuartile",e[e.complete=4]="complete"}(e.AdEvent||(e.AdEvent={}));var t=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.onContentPaused=new Phaser.Signal,i.onContentResumed=new Phaser.Signal,i.onAdProgression=new Phaser.Signal,i.onAdsDisabled=new Phaser.Signal,i.onAdClicked=new Phaser.Signal,i.onAdRewardGranted=new Phaser.Signal,i.onBannerShown=new Phaser.Signal,i.onBannerHidden=new Phaser.Signal,i.bannerActive=!1,i.provider=null,i.wasMuted=!1,Object.defineProperty(e,"ads",{value:i}),i}return __extends(n,t),n.prototype.setAdProvider=function(e){this.provider=e,this.provider.setManager(this)},n.prototype.showAd=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(null===this.provider)throw new Error("Can not request an ad without an provider, please attach an ad provider!");t[0]!==e.AdProvider.CocoonAdType.banner&&(this.wasMuted=this.game.sound.mute,this.game.sound.mute=!0),this.provider.showAd.apply(this.provider,t)},n.prototype.preloadAd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(null===this.provider)throw new Error("Can not preload an ad without an provider, please attach an ad provider!");this.provider.preloadAd.apply(this.provider,e)},n.prototype.destroyAd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(null===this.provider)throw new Error("Can not destroy an ad without an provider, please attach an ad provider!");this.provider.destroyAd.apply(this.provider,e)},n.prototype.hideAd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(null===this.provider)throw new Error("Can not hide an ad without an provider, please attach an ad provider!");this.unMuteAfterAd(),this.provider.hideAd.apply(this.provider,e)},n.prototype.adsEnabled=function(){return this.provider.adsEnabled},n.prototype.unMuteAfterAd=function(){this.wasMuted||(this.game.sound.mute=!1)},n}(Phaser.Plugin);e.AdManager=t}(PhaserAds||(PhaserAds={}));var PhaserAds;!function(e){!function(e){var t;!function(e){e[e.AdMob=0]="AdMob",e[e.MoPub=1]="MoPub",e[e.Chartboost=2]="Chartboost",e[e.Heyzap=3]="Heyzap"}(t=e.CocoonProvider||(e.CocoonProvider={}));var n;!function(e){e[e.banner=0]="banner",e[e.interstitial=1]="interstitial",e[e.insentive=2]="insentive"}(n=e.CocoonAdType||(e.CocoonAdType={}));var i=function(){function e(e,n,i){if(this.adsEnabled=!1,this.banner=null,this.bannerShowable=!1,this.interstitial=null,this.interstitialShowable=!1,this.insentive=null,this.insentiveShowable=!1,(e.device.cordova||e.device.crosswalk)&&Cocoon&&Cocoon.Ad){switch(this.adsEnabled=!0,n){default:case t.AdMob:this.cocoonProvider=Cocoon.Ad.AdMob;break;case t.Chartboost:this.cocoonProvider=Cocoon.Ad.Chartboost;break;case t.Heyzap:this.cocoonProvider=Cocoon.Ad.Heyzap;break;case t.MoPub:this.cocoonProvider=Cocoon.Ad.MoPub}this.cocoonProvider.configure(i)}}return e.prototype.setManager=function(e){this.adManager=e},e.prototype.showAd=function(e){if(!this.adsEnabled)return this.adManager.unMuteAfterAd(),void(e!==n.banner&&this.adManager.onContentResumed.dispatch());if(e===n.banner){if(!this.bannerShowable||null===this.banner)return void this.adManager.unMuteAfterAd();this.adManager.onBannerShown.dispatch(this.banner.width,this.banner.height),this.adManager.bannerActive=!0,this.banner.show()}if(e===n.interstitial){if(!this.interstitialShowable||null===this.interstitial)return this.adManager.unMuteAfterAd(),void this.adManager.onContentResumed.dispatch(n.interstitial);this.interstitial.show()}if(e===n.insentive){if(!this.insentiveShowable||null===this.insentive)return this.adManager.unMuteAfterAd(),void this.adManager.onContentResumed.dispatch(n.insentive);this.insentive.show()}},e.prototype.preloadAd=function(e,t,i){var a=this;this.adsEnabled&&(this.destroyAd(e),e===n.banner&&(this.banner=this.cocoonProvider.createBanner(t),i&&this.banner.setLayout(i),this.banner.on("load",function(){a.bannerShowable=!0}),this.banner.on("fail",function(){a.bannerShowable=!1,a.banner=null}),this.banner.on("click",function(){a.adManager.onAdClicked.dispatch(n.banner)}),this.banner.on("show",function(){}),this.banner.on("dismiss",function(){}),this.banner.load()),e===n.interstitial&&(this.interstitial=this.cocoonProvider.createInterstitial(t),this.interstitial.on("load",function(){a.interstitialShowable=!0}),this.interstitial.on("fail",function(){a.interstitialShowable=!1,a.interstitial=null}),this.interstitial.on("click",function(){a.adManager.onAdClicked.dispatch(n.interstitial)}),this.interstitial.on("show",function(){a.adManager.onContentPaused.dispatch(n.interstitial)}),this.interstitial.on("dismiss",function(){a.adManager.unMuteAfterAd(),a.adManager.onContentResumed.dispatch(n.interstitial),a.interstitialShowable=!1,a.interstitial=null}),this.interstitial.load()),e===n.insentive&&(this.insentive=this.cocoonProvider.createRewardedVideo(t),this.insentive.on("load",function(){a.insentiveShowable=!0}),this.insentive.on("fail",function(){a.insentiveShowable=!1,a.insentive=null}),this.insentive.on("click",function(){a.adManager.onAdClicked.dispatch(n.insentive)}),this.insentive.on("show",function(){a.adManager.onContentPaused.dispatch(n.insentive)}),this.insentive.on("dismiss",function(){a.adManager.unMuteAfterAd(),a.adManager.onContentResumed.dispatch(n.insentive),a.insentiveShowable=!1,a.insentive=null}),this.insentive.on("reward",function(){a.adManager.unMuteAfterAd(),a.adManager.onAdRewardGranted.dispatch(n.insentive),a.insentiveShowable=!1,a.insentive=null}),this.insentive.load()))},e.prototype.destroyAd=function(e){if(this.adsEnabled){if(e===n.banner&&null!==this.banner){try{this.cocoonProvider.releaseBanner(this.banner)}catch(e){}this.banner=null,this.bannerShowable=!1}e===n.interstitial&&null!==this.interstitial&&(this.cocoonProvider.releaseInterstitial(this.interstitial),this.interstitial=null,this.interstitialShowable=!1)}},e.prototype.hideAd=function(e){this.adsEnabled&&(e===n.interstitial&&null!==this.interstitial&&this.interstitial.hide(),e===n.banner&&null!==this.banner&&(this.adManager.bannerActive&&(this.adManager.bannerActive=!1,this.adManager.onBannerHidden.dispatch(this.banner.width,this.banner.height)),this.banner.hide()),e===n.insentive&&null!==this.insentive&&this.insentive.hide())},e}();e.CocoonAds=i}(e.AdProvider||(e.AdProvider={}))}(PhaserAds||(PhaserAds={}));var PhaserAds;!function(e){!function(e){var t;!function(e){e[e.Interstitial=0]="Interstitial",e[e.Video=1]="Video",e[e.Rewarded=2]="Rewarded",e[e.Banner=3]="Banner"}(t=e.HeyzapAdTypes||(e.HeyzapAdTypes={}));var n=function(){function e(e,t){var n=this;this.adsEnabled=!1,(e.device.cordova||e.device.crosswalk)&&(this.adsEnabled=!0,HeyzapAds.start(t).then(function(){},function(e){n.adsEnabled=!1}))}return e.prototype.setManager=function(e){this.adManager=e},e.prototype.showAd=function(e,n){var i=this;switch(this.adsEnabled||(this.adManager.unMuteAfterAd(),this.adManager.onContentResumed.dispatch()),e){case t.Interstitial:HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.HIDE,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.InterstitialAd.Events.HIDE)}),HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.SHOW_FAILED,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.InterstitialAd.Events.SHOW_FAILED)}),HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.CLICKED,function(){i.adManager.onAdClicked.dispatch(HeyzapAds.InterstitialAd.Events.CLICKED)}),HeyzapAds.InterstitialAd.show().then(function(){i.adManager.onContentPaused.dispatch()},function(e){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch()});break;case t.Video:HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.HIDE,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.VideoAd.Events.HIDE)}),HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.SHOW_FAILED,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.VideoAd.Events.SHOW_FAILED)}),HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.CLICKED,function(){i.adManager.onAdClicked.dispatch(HeyzapAds.VideoAd.Events.CLICKED)}),HeyzapAds.VideoAd.show().then(function(){i.adManager.onContentPaused.dispatch()},function(e){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch()});break;case t.Rewarded:HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.HIDE,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.IncentivizedAd.Events.HIDE)}),HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.SHOW_FAILED,function(){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch(HeyzapAds.IncentivizedAd.Events.SHOW_FAILED)}),HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.CLICKED,function(){i.adManager.onAdClicked.dispatch(HeyzapAds.IncentivizedAd.Events.CLICKED)}),HeyzapAds.IncentivizedAd.show().then(function(){i.adManager.onContentPaused.dispatch()},function(e){i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch()});break;case t.Banner:HeyzapAds.BannerAd.show(n).then(function(){},function(e){})}},e.prototype.preloadAd=function(e){this.adsEnabled&&e===t.Rewarded&&HeyzapAds.IncentivizedAd.fetch().then(function(){},function(e){})},e.prototype.destroyAd=function(e){this.adsEnabled&&e===t.Banner&&HeyzapAds.BannerAd.destroy().then(function(){},function(e){})},e.prototype.hideAd=function(e){this.adsEnabled&&e===t.Banner&&HeyzapAds.BannerAd.hide().then(function(){},function(e){})},e}();e.CordovaHeyzap=n}(e.AdProvider||(e.AdProvider={}))}(PhaserAds||(PhaserAds={}));var PhaserAds;!function(e){!function(e){!function(e){e[e.preroll=0]="preroll",e[e.midroll=1]="midroll"}(e.GameDistributionAdType||(e.GameDistributionAdType={}));var t=function(){function e(e,t,n){var i=this;this.adsEnabled=!0,this.areAdsEnabled(),GD_OPTIONS={gameId:t,userId:n,advertisementSettings:{debug:!1,prefix:"gdApi-",autoplay:!1,responsive:!0,width:640,height:300,locale:"en"},onEvent:function(e){switch(console.log("event.name = ",e.name),e.name){case"API_GAME_START":"undefined"!=typeof gdApi&&gdApi.play(),i.adManager.unMuteAfterAd(),i.adManager.onContentResumed.dispatch();break;case"API_GAME_PAUSE":i.adManager.onContentPaused.dispatch()}}},function(e,t,n){var i,a=e.getElementsByTagName(t)[0];e.getElementById(n)||((i=e.createElement(t)).id=n,i.src="//html5.api.gamedistribution.com/main.min.js",a.parentNode.insertBefore(i,a))}(document,"script","gamedistribution-jssdk")}return e.prototype.setManager=function(e){this.adManager=e},e.prototype.showAd=function(e){if(console.log("show ad"),this.adsEnabled){if(gdApi&&void 0===gdApi.showBanner)return this.adsEnabled=!1,this.adManager.unMuteAfterAd(),void this.adManager.onContentResumed.dispatch();gdApi.showBanner()}else this.adManager.unMuteAfterAd(),this.adManager.onContentResumed.dispatch()},e.prototype.preloadAd=function(){},e.prototype.destroyAd=function(){},e.prototype.hideAd=function(){},e.prototype.areAdsEnabled=function(){var e=this,t=document.createElement("div");t.innerHTML="&nbsp;",t.className="adsbox",t.style.position="absolute",t.style.fontSize="10px",document.body.appendChild(t);var n=function(){var e=!0;return 0===t.offsetHeight&&(e=!1),t.parentNode.removeChild(t),e};window.setTimeout(function(){e.adsEnabled=n()},100)},e}();e.GameDistributionAds=t}(e.AdProvider||(e.AdProvider={}))}(PhaserAds||(PhaserAds={}));var PhaserAds;!function(e){!function(t){var n=function(){function t(e,t){this.adsManager=null,this.googleEnabled=!1,this.adsEnabled=!0,this.adTagUrl="",this.adRequested=!1,this.adManager=null,this.resizeListener=null,this.areAdsEnabled(),"undefined"!=typeof google&&(this.googleEnabled=!0,google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale("ru"),this.gameContent="string"==typeof e.parent?document.getElementById(e.parent):e.parent,this.gameContent.style.position="absolute",this.gameContent.style.width="100%",this.adContent=this.gameContent.parentNode.appendChild(document.createElement("div")),this.adContent.id="phaser-ad-container",this.adContent.style.position="absolute",this.adContent.style.zIndex="9999",this.adContent.style.display="none",this.adContent.style.top="0",this.adContent.style.left="0",this.adContent.style.width="100%",this.adContent.style.height="100%",this.adContent.style.overflow="hidden",this.adTagUrl=t,this.game=e,this.adDisplay=new google.ima.AdDisplayContainer(this.adContent),this.adLoader=new google.ima.AdsLoader(this.adDisplay),this.adLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdManagerLoader,!1,this),this.adLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this))}return t.prototype.setManager=function(e){this.adManager=e},t.prototype.showAd=function(e){if(console.log("Ad Requested"),!this.adRequested)if(this.adsEnabled||this.adManager.onAdsDisabled.dispatch(!0),this.googleEnabled){this.adDisplay.initialize();var t=new google.ima.AdsRequest;t.adTagUrl=this.adTagUrl+this.parseCustomParams(e);var n=window.innerWidth,i=window.innerHeight;this.game.scale.isFullScreen&&document.body.clientHeight<window.innerHeight&&(i=document.body.clientHeight,n=document.body.clientWidth),t.linearAdSlotWidth=n,t.linearAdSlotHeight=i,t.nonLinearAdSlotWidth=n,t.nonLinearAdSlotHeight=i,t.forceNonLinearFullSlot=!0;try{this.adRequested=!0,this.adLoader.requestAds(t)}catch(e){console.log(e),this.onContentResumeRequested()}}else this.onContentResumeRequested()},t.prototype.preloadAd=function(){},t.prototype.destroyAd=function(){},t.prototype.hideAd=function(){},t.prototype.onAdManagerLoader=function(e){var t=this;console.log("AdsManager loaded");var n=new google.ima.AdsRenderingSettings;n.restoreCustomPlaybackStateOnAdBreakComplete=!0;var i=e.getAdsManager(this.gameContent,n);this.adsManager=i,console.log(i.isCustomClickTrackingUsed()),i.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested,!1,this),i.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested,!1,this),i.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this),[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE].forEach(function(e){i.addEventListener(e,t.onAdEvent,!1,t)});try{this.adContent.style.display="block";var a=window.innerWidth,o=window.innerHeight;this.adsManager.init(a,o,google.ima.ViewMode.NORMAL),this.adsManager.start(),this.resizeListener=function(){null!==t.adsManager&&(console.log("Resizing ad size"),t.adsManager.resize(window.innerWidth,window.innerHeight,google.ima.ViewMode.NORMAL))},window.addEventListener("resize",this.resizeListener)}catch(e){console.log("Adsmanager error:",e),this.onAdError(e)}},t.prototype.onAdEvent=function(t){switch(console.log("onAdEvent",t),t.type){case google.ima.AdEvent.Type.CLICK:this.adManager.onAdClicked.dispatch();break;case google.ima.AdEvent.Type.LOADED:this.adRequested=!1;var n=t.getAd();console.log("is ad linear?",n.isLinear()),n.isLinear()||this.onContentResumeRequested();break;case google.ima.AdEvent.Type.STARTED:this.adManager.onAdProgression.dispatch(e.AdEvent.start);break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this.adManager.onAdProgression.dispatch(e.AdEvent.firstQuartile);break;case google.ima.AdEvent.Type.MIDPOINT:this.adManager.onAdProgression.dispatch(e.AdEvent.midPoint);break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this.adManager.onAdProgression.dispatch(e.AdEvent.thirdQuartile);break;case google.ima.AdEvent.Type.COMPLETE:this.adManager.onAdProgression.dispatch(e.AdEvent.complete);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.onContentResumeRequested()}},t.prototype.onAdError=function(e){console.log("gneric ad error",e),null!==this.adsManager&&(this.adsManager.destroy(),this.adsManager=null,null!==this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)),this.adRequested&&(this.adRequested=!1),this.onContentResumeRequested()},t.prototype.onContentPauseRequested=function(){console.log("onContentPauseRequested",arguments),this.adManager.onContentPaused.dispatch()},t.prototype.onContentResumeRequested=function(){if(console.log("onContentResumeRequested",arguments),"undefined"==typeof google)return this.adManager.unMuteAfterAd(),void this.adManager.onContentResumed.dispatch();this.adContent.style.display="none",this.adManager.unMuteAfterAd(),this.adManager.onContentResumed.dispatch()},t.prototype.parseCustomParams=function(e){if(void 0!==e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length>0&&(t+="&"),t+=n+"="+(Array.isArray(e[n])?e[n].join(","):e[n]));return"&cust_params="+encodeURIComponent(t)}return""},t.prototype.areAdsEnabled=function(){var e=this,t=document.createElement("div");t.innerHTML="&nbsp;",t.className="adsbox",t.style.position="absolute",t.style.fontSize="10px",document.body.appendChild(t);var n=function(){var e=!0;return 0===t.offsetHeight&&(e=!1),t.parentNode.removeChild(t),e};window.setTimeout(function(){e.adsEnabled=n()},100)},t}();t.Ima3=n}(e.AdProvider||(e.AdProvider={}))}(PhaserAds||(PhaserAds={}));